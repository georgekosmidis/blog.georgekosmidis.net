<p>Did you know that HTTP_X_FORWARDED_FOR can return multiple IPs? According to <a href="http://en.wikipedia.org/wiki/X-Forwarded-For" target="_blank" rel="noopener noreferrer">http://en.wikipedia.org/wiki/X-Forwarded-For</a> the format is:</p>
<pre>X-Forwarded-For: client, proxy1, proxy2
</pre>
<p> </p>
<p>So you just need:</p>
<p><script src="https://gist.github.com/georgekosmidis/f034aae91af16a0bbf8276747680cadc.js"></script></p>
<p>Simple as that <img src="media\1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p><p>The post <a href="https://blog.georgekosmidis.net/c-getting-a-user-ip-behind-a-proxy-http_x_forwarded_for/">C#: Getting a user IP behind a proxy (HTTP_X_FORWARDED_FOR)</a> first appeared on <a href="https://blog.georgekosmidis.net">George Kosmidis</a>.</p>